<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>基于GPRS的火灾监控系统</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="apple-mobile-web-app-status-bar-style" content="black"> 
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="format-detection" content="telephone=no">
 
  <link rel="stylesheet" href="./layui/css/layui.css">
  <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
   <!-- 引入 ECharts 文件 -->
   <script src="js/echarts.js"></script>
</head>
<body class="layui-layout-body">
	<script type="text/javascript" src="https://cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script>　
   	
   	<!-- 生成一天中各模块数据 -->
   	<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main" style="width: 600px;height:400px;"></div>
   	<script type="text/javascript">
		// 基于准备好的dom，初始化echarts实例
		var myChart = echarts.init(document.getElementById('main'));
		// 显示标题
		option = {
			title: {
     	        text: '一天当中各模块数据',
     	        subtext: '数据为虚构'
     	  	},	
		    xAxis: {
		        type: 'category',
		        data: []
		    },
		    yAxis: {
		        type: 'value'
		    },
		    series: [{
		        data: [],
		        type: 'bar'
		    }]
		};
		myChart.showLoading(); //loading动画
		
		var names = new Array("d_smoke","d_infrared","d_temperature");    //类别数组（实际用来盛放X轴坐标值）
		var values = [];
	   	$.ajax({
	   		async : true,
	        type : "post",
	        url : "./user/chart/daysView",
	        dataType:"json",
	        contentType:'application/json;charset=utf-8',
	        success:function(result) {
	            if(result)
	            {
	            	var json= JSON.stringify(result);//将服务器传递json对象转成json字符串
	            	var obj = eval('(' + json + ')');//将json字符串转成json对象
	            	
// 	            	alert(obj[0].d_dat);
	            	
	            	
// 	            	values[0] = obj[0].d_dat;
	            	values[0] = obj[0].d_smoke;
	            	values[1] = obj[0].d_infrared;
	            	values[2] = obj[0].d_temperature;
	            	alert(values[0]);
	            	
	            	myChart.hideLoading();
	            	myChart.setOption({
	                    xAxis:{  
	                        data:names
	                    },
		            	series: [{
		    		        data: values
		    		    }]
	                });
	            }             
	       },
	        error : function(errorMsg) {
	            //请求失败时执行该函数
	            alert("请求数据失败!");
	        }
	    });
	 // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
   	</script>
</body>
</html>